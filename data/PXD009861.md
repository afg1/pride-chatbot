### Accession
PXD009861

### Title
Fast open modification spectral library searching through approximate nearest neighbor indexing

### Description
Open modification searching (OMS) is a powerful search strategy that identifies peptides carrying any type of modification by allowing a modified spectrum to match against its unmodified variant by using a very wide precursor mass window. A drawback of this strategy, however, is that it leads to a large increase in search time. Although performing an open search can be done using existing spectral library search engines by simply setting a wide precursor mass window, none of these tools have been optimized for OMS, leading to excessive runtimes and suboptimal identification results.  This data set contains the evaluation results of the ANN-SoLo tool for fast and accurate open spectral library searching. ANN-SoLo uses approximate nearest neighbor indexing to speed up OMS by selecting only a limited number of the most relevant library spectra to compare to an unknown query spectrum. This approach is combined with a cascade search strategy to maximize the number of identified unmodified and modified spectra while strictly controlling the false discovery rate, as well as a shifted dot product score to sensitively match modified spectra to their unmodified counterparts.  ANN-SoLo achieves state-of-the-art performance in terms of speed and the number of identifications. On a previously published human cell line data set, ANN-SoLo confidently identifies more spectra than SpectraST or MSFragger and achieves a speedup of an order of magnitude compared to SpectraST.

### Sample Protocol
Two previously published data sets were used.  (1) The iPRG2012 data set as described by Chalkley et al. (doi:10.1021/pr301063v). This data set we used was generated in the context of the 2012 study by the Proteome Informatics Research Group of the Association of Biomolecular Research Facilities. The goal of this study was to assess the community's ability to analyze modified peptides. Towards this end, various participating researchers were asked to identify an unknown data set, after which their proficiency in handling modified peptides was evaluated. The provided data set consisted of a mixture of synthetic peptides with biologically occurring modifications combined with a yeast whole cell lysate as background, and the spectra were measured using a TripleTOF instrument.  (2) The HEK293 data set as described by Chick et al. (doi:10.1038/nbt.3267). This data set consists of spectra measured from the HEK293 human cell line. The HEK293 cells were first lysed, trypsinized, and separated into 24 fractions, after which high-resolution and high-mass accuracy MS/MS spectra were obtained on an LTQ Orbitrap Elite mass spectrometer.

### Data Protocol
To search the iPRG2012 data set the human HCD spectral library compiled by NIST (version 2016/09/12) and a TripleTOF yeast spectral library from Selevsek et al. (doi:10.1074/mcp.M113.035550) were used. First, matches to decoy proteins were removed from the yeast spectral library, after which both spectral libraries were concatenated using SpectraST while removing duplicates by retaining only the best replicate spectrum for each individual peptide ion. Next, decoy spectra were added in a 1:1 ratio using the shuffle-and-reposition method. To search the HEK293 data set the MassIVE-KB peptide spectral library (version 2017/11/27) was used. Duplicates were removed using SpectraST by retaining only the best replicate spectrum for each individual peptide ion, and decoy spectra were added in a 1:1 ratio using the shuffle-and-reposition method.  Prior to spectral library searching with ANN-SoLo both the query spectra and library spectra were similarly preprocessed. Peaks corresponding to the precursor ion and noise peaks with an intensity below 1% of the intensity of the most intense peak were removed and, if applicable, the spectra were further restricted to their 50 most intense peaks. After peak removal, any spectrum that contained fewer than 10 peaks remaining or with a mass range less than 250 Da were discarded. Finally, peak intensities were rank transformed. For the iPRG2012 data set a precursor mass window of 20 ppm was used for the standard search and 20 ppm followed by 300 Da for the cascade open searches. Additionally, a fragment mass tolerance of 0.02 Da was used in all cases. For the HEK293 data set a precursor mass window of 5 ppm was used for the standard searches and a precursor mass window of 5 ppm followed by 500 Da was used for the cascade open searches. For all HEK293 searches a fragment mass tolerance of 0.02 Da was used.  The search the HEK293 data set we used SpectraST version 5.0 as part of the Trans-Proteomic Pipeline version 5.1.0. Spectra were preprocessed to have a minimum mass range of 250 Da and only the 50 most intense peaks were retained. Peak-to-peak matching and rank-based scoring was used to evaluate spectrum matches, with library caching enabled. Similar to the ANN-SoLo settings a precursor mass window of 500 Da was used for the open searches, while a precursor mass window of 0.02 Da was used for the standard searches. A fragment mass tolerance of 0.02 Da was used in all cases.  To search the HEK293 data set with MSFragger we used the neXtProt database of human protein sequences (version 2018/01/17) complemented with common contaminants from the cRAP database (version 2012/01/01). Next, a concatenated target-decoy database was generated by appending an equal number of shuffled decoy sequences using Crux. MSFragger was configured to consider tryptic peptides with up to 2 missed cleavages, and cysteine carbamidomethylation was specified as a static modification. A precursor mass window of 5 ppm was used for the standard searches, and a precursor mass window of 500 Da was used for the open searches. In both cases a fragment mass tolerance of 0.02 was used.

### Publication Abstract
Open modification searching (OMS) is a powerful search strategy that identifies peptides carrying any type of modification by allowing a modified spectrum to match against its unmodified variant by using a very wide precursor mass window. A drawback of this strategy, however, is that it leads to a large increase in search time. Although performing an open search can be done using existing spectral library search engines by simply setting a wide precursor mass window, none of these tools have been optimized for OMS, leading to excessive runtimes and suboptimal identification results. We present the ANN-SoLo tool for fast and accurate open spectral library searching. ANN-SoLo uses approximate nearest neighbor indexing to speed up OMS by selecting only a limited number of the most relevant library spectra to compare to an unknown query spectrum. This approach is combined with a cascade search strategy to maximize the number of identified unmodified and modified spectra while strictly controlling the false discovery rate as well as a shifted dot product score to sensitively match modified spectra to their unmodified counterparts. ANN-SoLo achieves state-of-the-art performance in terms of speed and the number of identifications. On a previously published human cell line data set, ANN-SoLo confidently identifies more spectra than SpectraST or MSFragger and achieves a speedup of an order of magnitude compared with SpectraST. ANN-SoLo is implemented in Python and C++. It is freely available under the Apache 2.0 license at https://github.com/bittremieux/ANN-SoLo .

### Keywords
Open modification searching, Spectral library, Ptm

### Affiliations
Department of Mathematics and Computer Science, University of Antwerp, Belgium
University of Antwerp

### Submitter
Wout Bittremieux

### Lab Head
Dr Kris Laukens
Department of Mathematics and Computer Science, University of Antwerp, Belgium


